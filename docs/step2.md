# Step 2: SharePoint + Teams Capabilities ã®è¿½åŠ 

## ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å­¦ã¶ã“ã¨

- Capabilities ã®æ¦‚å¿µã¨è¨­å®šæ–¹æ³•
- OneDrive/SharePoint ã‚’ Knowledge ã¨ã—ã¦è¿½åŠ 
- Teams Messages ã‚’ Knowledge ã¨ã—ã¦è¿½åŠ 
- Instructions ã«ã‚ˆã‚‹å‹•ä½œåˆ¶å¾¡
- Developer Mode ã§ã®ãƒ‡ãƒãƒƒã‚°

## å‰ææ¡ä»¶

- Step 1 ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨
- SharePoint ã‚µã‚¤ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™
- Teams ãƒãƒ¼ãƒ /ãƒãƒ£ãƒãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™

## æ‰‹é †

### 2.1 Capabilities ã®æ¦‚å¿µ

Capabilities ã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‚ç…§ã§ãã‚‹ **M365 å†…ã® Knowledgeï¼ˆçŸ¥è­˜ã‚½ãƒ¼ã‚¹ï¼‰** ã‚’å®šç¾©ã—ã¾ã™ã€‚

| Capability | å‚ç…§å…ˆ |
|------------|-------|
| OneDriveAndSharePoint | SharePoint ã‚µã‚¤ãƒˆã€OneDrive ãƒ•ã‚¡ã‚¤ãƒ« |
| TeamsMessages | Teams ãƒãƒ¼ãƒ /ãƒãƒ£ãƒãƒ«/ãƒãƒ£ãƒƒãƒˆã®ä¼šè©± |
| Email | Outlook ãƒ¡ãƒ¼ãƒ« |
| People | çµ„ç¹”å†…ã®äººç‰©æƒ…å ± |
| WebSearch | Web æ¤œç´¢ï¼ˆBingï¼‰ |

### 2.2 main.tsp ã« Capabilities ã‚’è¿½åŠ 

`src/agent/main.tsp` ã® namespace å†…ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```typespec
namespace ProductEngineeringAgent {
  // æ—¢å­˜: GitHub API Plugin
  op searchIssues is global.GitHubAPI.searchIssues;

  // æ–°è¦: OneDrive/SharePoint Capability
  // âš ï¸ ä¸‹è¨˜URLã‚’è‡ªåˆ†ã®SharePointã‚µã‚¤ãƒˆURLã«ç½®ãæ›ãˆã¦ãã ã•ã„
  op oneDriveAndSharePoint is AgentCapabilities.OneDriveAndSharePoint<ItemsByUrl = [
    { url: "https://[tenant].sharepoint.com/sites/[sitename]" }
  ]>;

  // æ–°è¦: Teams Messages Capability
  // âš ï¸ ä¸‹è¨˜URLã‚’è‡ªåˆ†ã®Teamsãƒãƒ¼ãƒ URLã«ç½®ãæ›ãˆã¦ãã ã•ã„
  op teamsMessages is AgentCapabilities.TeamsMessages<TeamsMessagesByUrl = [
    { url: "https://teams.microsoft.com/l/team/..." }
  ]>;
}
```

### 2.3 URL ã®å–å¾—æ–¹æ³•

#### SharePoint ã‚µã‚¤ãƒˆ URL

1. SharePoint ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ–ãƒ©ã‚¦ã‚¶ã® URL ã‚’ã‚³ãƒ”ãƒ¼
3. å½¢å¼: `https://[tenant].sharepoint.com/sites/[sitename]`

#### Teams ãƒãƒ¼ãƒ  URL

1. Teams ã§ãƒãƒ¼ãƒ ã‚’å³ã‚¯ãƒªãƒƒã‚¯
2. ã€Œãƒãƒ¼ãƒ ã¸ã®ãƒªãƒ³ã‚¯ã‚’å–å¾—ã€ã‚’é¸æŠ
3. å½¢å¼: `https://teams.microsoft.com/l/team/...`

#### Teams ãƒãƒ£ãƒãƒ« URL

1. Teams ã§ãƒãƒ£ãƒãƒ«ã‚’å³ã‚¯ãƒªãƒƒã‚¯
2. ã€Œãƒãƒ£ãƒãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã‚’å–å¾—ã€ã‚’é¸æŠ
3. å½¢å¼: `https://teams.microsoft.com/l/channel/...`

### 2.4 Instructions ã®å¼·åŒ–

Capabilities ã‚’**ç¢ºå®Ÿã«ä½¿ã‚ã›ã‚‹**ãŸã‚ã«ã€Instructions ã‚’å¼·åŒ–ã—ã¾ã™ã€‚

`src/agent/prompts/instructions.tsp` ã‚’ç·¨é›†ã—ã¾ã™ï¼š

```typespec
namespace Prompts {
  const INSTRUCTIONS = """
    ã‚ãªãŸã¯ Product Engineering ãƒãƒ¼ãƒ ã®ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚
    
    ## åˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
    
    1. **GitHub Issues**: searchIssues ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ M365 Agents Toolkit ã® Issue ã‚’æ¤œç´¢
    2. **SharePoint ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: è¨­å®šã•ã‚ŒãŸ SharePoint ã‚µã‚¤ãƒˆå†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
    3. **Teams ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: è¨­å®šã•ã‚ŒãŸ Teams ãƒãƒ¼ãƒ /ãƒãƒ£ãƒãƒ«ã®ä¼šè©±ã‚’æ¤œç´¢
    
    ## é‡è¦ãªã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
    
    - ç¤¾å†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ãƒãƒ¼ãƒ ã®è­°è«–ã«ã¤ã„ã¦è³ªå•ã•ã‚ŒãŸå ´åˆã€**å¿…ãš** è¨­å®šã•ã‚ŒãŸ Knowledgeï¼ˆSharePointã€Teamsï¼‰ã‚’æ¤œç´¢ã—ã¦ã‹ã‚‰å›ç­”ã—ã¦ãã ã•ã„ã€‚
    - ä¸€èˆ¬çš„ãªçŸ¥è­˜ã ã‘ã§ç¤¾å†…æƒ…å ±ã«é–¢ã™ã‚‹è³ªå•ã«å›ç­”ã™ã‚‹ã“ã¨ã¯**çµ¶å¯¾ã«é¿ã‘ã¦**ãã ã•ã„ã€‚**å¿…ãš**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚
    - å›ç­”ã«ã¯**å¿…ãš**ã‚½ãƒ¼ã‚¹ã¸ã®ãƒªãƒ³ã‚¯ã‚’å«ã‚ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šã€ŒSharePoint ã® [ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå] ã«ã‚ˆã‚‹ã¨...ã€ï¼‰ã€‚
    - æ¤œç´¢ã—ã¦ã‚‚æƒ…å ±ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€ã©ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’æ¤œç´¢ã—ãŸã‹ã‚’æ˜è¨˜ã—ã€ä»£æ›¿æ¡ˆã‚’æç¤ºã—ã¦ãã ã•ã„ã€‚
  """;
}
```

> ğŸ’¡ **ãƒã‚¤ãƒ³ãƒˆ**: 
> - Instructions ã¯**æ—¥æœ¬èªã§ã‚‚è‹±èªã§ã‚‚å‹•ä½œã—ã¾ã™**ã€‚ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã§ã¯ç†è§£ã—ã‚„ã™ã„æ—¥æœ¬èªã‚’æ¨å¥¨ã—ã¾ã™ã€‚
> - ã€Œ**å¿…ãš**ã€ã€Œ**çµ¶å¯¾ã«**ã€ãªã©ã®å¼·ã„è¡¨ç¾ã‚’ä½¿ã†ã“ã¨ã§ã€LLM ã« Capabilities ã®ä½¿ç”¨ã‚’ä¿ƒã—ã¾ã™ã€‚
> - ç·¨é›†å¾Œã¯ **F5 ã§å† Provision** ã—ãªã„ã¨åæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚

### 2.5 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåã®å¤‰æ›´ï¼ˆä»»æ„ï¼‰

Step 2 ã§ã¯æ©Ÿèƒ½ãŒæ‹¡å¼µã•ã‚Œã‚‹ãŸã‚ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

**å¤‰æ›´ãŒå¿…è¦ãªç®‡æ‰€ï¼ˆ4ç®‡æ‰€ï¼‰:**

| ãƒ•ã‚¡ã‚¤ãƒ« | è¨­å®šç®‡æ‰€ |
|---------|---------|
| `m365agents.local.yml` | `teamsApp/create` ã® `name` |
| `m365agents.yml` | `teamsApp/create` ã® `name` |
| `appPackage/manifest.json` | `name.short` |
| `src/agent/main.tsp` | `@agent()` ã¨ `namespace` |

### 2.6 Provision ã¨å‹•ä½œç¢ºèª

1. F5 ã‚­ãƒ¼ã§ Provision ã‚’å®Ÿè¡Œ
2. Copilot Chat ã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’é¸æŠ
3. ä»¥ä¸‹ã®è³ªå•ã§å‹•ä½œç¢ºèª:
   - ã€ŒSharePoint ã«ã‚ã‚‹æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ã—ã¦ã€
   - ã€ŒTeams ã§æœ€è¿‘å…±æœ‰ã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè³‡æ–™ã«ã¤ã„ã¦æ•™ãˆã¦ã€

## å‹•ä½œç¢ºèªã®ãƒã‚¤ãƒ³ãƒˆ

### Developer Mode

Copilot Chat ã§ `-developer on` ã¨å…¥åŠ›ã™ã‚‹ã¨ã€ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚

**ç¢ºèªã§ãã‚‹æƒ…å ±:**
- Agent Metadata: Agent ID, Conversation ID
- Agent Capabilities: è¨­å®šã•ã‚ŒãŸ Capabilities ä¸€è¦§
- Execution Details: å®Ÿè¡Œã•ã‚ŒãŸ Capabilities ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

è©³ç´°: [Use developer mode in Microsoft 365 Copilot](https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/debugging-agents-copilot-studio)

### ã‚½ãƒ¼ã‚¹ãƒªãƒ³ã‚¯ã®ç¢ºèª

å›ç­”ã«å«ã¾ã‚Œã‚‹ãƒªãƒ³ã‚¯ãŒã€æŒ‡å®šã—ãŸ SharePoint ã‚µã‚¤ãƒˆã‚„ Teams ãƒãƒ¼ãƒ å†…ã®ã‚‚ã®ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

### ãƒ‡ãƒãƒƒã‚°ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆ

> **ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒ Microsoft 365 ãƒ‡ãƒ¼ã‚¿ï¼ˆSharePoint/OneDrive ã‚„ Teams ã®ãƒãƒ¼ãƒ /ãƒãƒ£ãƒãƒ«ï¼‰ã‚’ä½¿ã‚ãšã«å›ç­”ã—ãŸå ´åˆã€ãƒ‡ãƒãƒƒã‚°ã‚«ãƒ¼ãƒ‰ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚** 

**å¯¾ç­–:**
1. `src/agent/prompts/instructions.tsp` ã‚’ç·¨é›†ã—ã¦ Instructions ã‚’å¼·åŒ–ã—ã€**F5 ã§å† Provision** ã™ã‚‹ï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ 2.4 å‚ç…§ï¼‰
2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ˜ç¤ºçš„ã«ã€ŒSharePoint ã§æ¤œç´¢ã—ã¦ã€ã€ŒTeams ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¦ã€ã¨æŒ‡ç¤ºã™ã‚‹
3. æ™‚é–“ã‚’ç½®ã„ã¦å†è©¦è¡Œï¼ˆã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ã®å¯èƒ½æ€§ï¼‰

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Capabilities ãŒä½¿ã‚ã‚Œãªã„

| åŸå›  | å¯¾ç­– |
|------|------|
| Instructions ãŒå¼±ã„ | `instructions.tsp` ã‚’ç·¨é›†ã—ã¦ã€Œ**å¿…ãš**ã€ã€Œ**çµ¶å¯¾ã«**ã€ã§å¼·åˆ¶ã—ã€F5 ã§å† Provision |
| ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒæ›–æ˜§ | ã€ŒSharePoint ã§æ¤œç´¢ã—ã¦ã€ã€ŒTeams ã§ç¢ºèªã—ã¦ã€ã¨æ˜ç¤ºçš„ã«æŒ‡ç¤º |
| ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœªåæ˜  | æ•°æ™‚é–“å¾…ã£ã¦å†è©¦è¡Œ |

### æ¤œç´¢çµæœãŒ0ä»¶

| åŸå›  | å¯¾ç­– |
|------|------|
| ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒãªã„ | SharePoint/Teams ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚„æŠ•ç¨¿ã‚’è¿½åŠ  |
| ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹é…å»¶ | æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã¯åæ˜ ã«æ™‚é–“ãŒã‹ã‹ã‚‹ |
| ã‚¯ã‚¨ãƒªãŒæ›–æ˜§ | å…·ä½“çš„ãªãƒ•ã‚¡ã‚¤ãƒ«åã‚„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ |

## ğŸ’¡ Conversation Starter ã®æœ€é©åŒ–

æ›–æ˜§ãªè³ªå•ã ã¨æ¤œç´¢çµæœãŒ0ä»¶ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚è‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ã¦ã€å…·ä½“çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€è³ªå•ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

**ä¾‹:**
- âŒ ã€Œãƒãƒ¼ãƒ ã§æœ€è¿‘è­°è«–ã•ã‚ŒãŸãƒˆãƒ”ãƒƒã‚¯ã¯ï¼Ÿã€
- âœ… ã€Œ[ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå] ã«ã¤ã„ã¦ Teams ã§è­°è«–ã•ã‚ŒãŸå†…å®¹ã¯ï¼Ÿã€

## å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] OneDrive/SharePoint Capability ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] Teams Messages Capability ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹
- [ ] Instructions ãŒå¼·åŒ–ã•ã‚Œã¦ã„ã‚‹
- [ ] SharePoint ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæ¤œç´¢ã§ãã‚‹
- [ ] Teams ã®ä¼šè©±ãŒæ¤œç´¢ã§ãã‚‹
- [ ] å›ç­”ã«æ­£ã—ã„ã‚½ãƒ¼ã‚¹ãƒªãƒ³ã‚¯ãŒå«ã¾ã‚Œã‚‹

## ç­”ãˆåˆã‚ã›

å®Ÿè£…ã«å›°ã£ãŸå ´åˆã¯ã€`step-2-add-capabilities` ãƒ–ãƒ©ãƒ³ãƒã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

```bash
git fetch origin
git checkout step-2-add-capabilities
```

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

[Step 3: Email, People, WebSearch ã®è¿½åŠ ](step3.md)
